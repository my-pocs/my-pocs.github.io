<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1167px" preserveAspectRatio="none" style="width:1627px;height:1167px;background:#FFFFFF;" version="1.1" viewBox="0 0 1627 1167" width="1627px" zoomAndPan="magnify"><defs><filter height="300%" id="f1knygxekpjfip" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="486" x="568.25" y="28.708">Валідація файлів при завантаженні через кабінет</text><rect fill="#FFFFFF" filter="url(#f1knygxekpjfip)" height="938.1797" style="stroke:#383838;stroke-width:1.0;" width="10" x="104.5" y="117.8438"/><rect fill="#FFFFFF" filter="url(#f1knygxekpjfip)" height="856.5156" style="stroke:#383838;stroke-width:1.0;" width="10" x="535.5" y="199.5078"/><rect fill="#FFFFFF" filter="url(#f1knygxekpjfip)" height="737.7188" style="stroke:#383838;stroke-width:1.0;" width="10" x="966.5" y="289.1719"/><rect fill="#FFFFFF" filter="url(#f1knygxekpjfip)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1060.5" x="10" y="668.4297"/><rect fill="#FFFFFF" filter="url(#f1knygxekpjfip)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1060.5" x="10" y="885.3594"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="109" x2="109" y1="107.8438" y2="1091.1563"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="540.5" x2="540.5" y1="107.8438" y2="1091.1563"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="971.5" x2="971.5" y1="107.8438" y2="1091.1563"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1434.5" x2="1434.5" y1="107.8438" y2="1091.1563"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1564.5" x2="1564.5" y1="107.8438" y2="1091.1563"/><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="46.5938" style="stroke:#383838;stroke-width:1.5;" width="175" x="20" y="56.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="29" y="76.2451">Клієнтський додаток</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="31" y="92.542">кабінету користувача</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="46.5938" style="stroke:#383838;stroke-width:1.5;" width="175" x="20" y="1090.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="29" y="1110.1514">Клієнтський додаток</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="31" y="1126.4482">кабінету користувача</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="46.5938" style="stroke:#383838;stroke-width:1.5;" width="130" x="473.5" y="56.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="518.5" y="76.2451">Kong</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="480.5" y="92.542">API Management</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="46.5938" style="stroke:#383838;stroke-width:1.5;" width="130" x="473.5" y="1090.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="518.5" y="1110.1514">Kong</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="480.5" y="1126.4482">API Management</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="46.5938" style="stroke:#383838;stroke-width:1.5;" width="174" x="882.5" y="56.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="944" y="76.2451">Сервіс</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="889.5" y="92.542">цифрових документів</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="46.5938" style="stroke:#383838;stroke-width:1.5;" width="174" x="882.5" y="1090.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="944" y="1110.1514">Сервіс</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="889.5" y="1126.4482">цифрових документів</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="62.8906" style="stroke:#383838;stroke-width:1.5;" width="130" x="1367.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1407" y="59.9482">Сервіс</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1392" y="76.2451">виконання</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="1374.5" y="92.542">бізнес-процесів</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="62.8906" style="stroke:#383838;stroke-width:1.5;" width="130" x="1367.5" y="1090.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1407" y="1110.1514">Сервіс</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1392" y="1126.4482">виконання</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="1374.5" y="1142.7451">бізнес-процесів</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="62.8906" style="stroke:#383838;stroke-width:1.5;" width="102" x="1511.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1537" y="59.9482">Сервіс</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1518.5" y="76.2451">мета-даних</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1533" y="92.542">UI-форм</text><rect fill="#F8F8F8" filter="url(#f1knygxekpjfip)" height="62.8906" style="stroke:#383838;stroke-width:1.5;" width="102" x="1511.5" y="1090.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1537" y="1110.1514">Сервіс</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1518.5" y="1126.4482">мета-даних</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1533" y="1142.7451">UI-форм</text><rect fill="#FFFFFF" filter="url(#f1knygxekpjfip)" height="938.1797" style="stroke:#383838;stroke-width:1.0;" width="10" x="104.5" y="117.8438"/><rect fill="#FFFFFF" filter="url(#f1knygxekpjfip)" height="856.5156" style="stroke:#383838;stroke-width:1.0;" width="10" x="535.5" y="199.5078"/><rect fill="#FFFFFF" filter="url(#f1knygxekpjfip)" height="737.7188" style="stroke:#383838;stroke-width:1.0;" width="10" x="966.5" y="289.1719"/><polygon fill="#383838" points="523.5,195.5078,533.5,199.5078,523.5,203.5078,527.5,199.5078" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="114.5" x2="529.5" y1="199.5078" y2="199.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="121.5" y="133.9106">Запит на завантаження файлу:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402" x="121.5" y="149.0435">POST "/documents/{processInstanceId}/{taskId}/{fieldName}"</text><ellipse cx="127" cy="159.7422" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="132.5" y="164.1763">Ідентифікатор сесії Kong;</text><ellipse cx="127" cy="174.875" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="132.5" y="179.3091">Мета-атрибути файлу;</text><ellipse cx="127" cy="190.0078" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="132.5" y="194.4419">Бінарний контент файлу;</text><polygon fill="#383838" points="954.5,285.1719,964.5,289.1719,954.5,293.1719,958.5,289.1719" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="545.5" x2="960.5" y1="289.1719" y2="289.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="552.5" y="223.5747">Запит на завантаження файлу:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402" x="552.5" y="238.7075">POST "/documents/{processInstanceId}/{taskId}/{fieldName}"</text><ellipse cx="558" cy="249.4063" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="563.5" y="253.8403">X-Access-Token;</text><ellipse cx="558" cy="264.5391" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="563.5" y="268.9731">Мета-атрибути файлу;</text><ellipse cx="558" cy="279.6719" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="563.5" y="284.106">Бінарний контент файлу;</text><polygon fill="#383838" points="1422.5,314.3047,1432.5,318.3047,1422.5,322.3047,1426.5,318.3047" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="976.5" x2="1428.5" y1="318.3047" y2="318.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359" x="983.5" y="313.2388">Отримання зв'язаної з задачею UI-форми за {taskId}</text><polygon fill="#383838" points="987.5,326.3047,977.5,330.3047,987.5,334.3047,983.5,330.3047" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="981.5" x2="1433.5" y1="330.3047" y2="330.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="993.5" y="343.3716">&lt;formKey&gt;</text><polygon fill="#383838" points="1552.5,372.5703,1562.5,376.5703,1552.5,380.5703,1556.5,376.5703" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="976.5" x2="1558.5" y1="376.5703" y2="376.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382" x="983.5" y="371.5044">Запит на отримання мета-даних UI-форми за {formKey}</text><path d="M981,389.5703 L981,580.5703 L1226,580.5703 L1226,399.5703 L1216,389.5703 L981,389.5703 " fill="#EBEBEB" filter="url(#f1knygxekpjfip)" style="stroke:#383838;stroke-width:1.0;"/><path d="M1216,389.5703 L1216,399.5703 L1226,399.5703 L1216,389.5703 " fill="#EBEBEB" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="987" y="406.6372">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="995" y="421.77">"components": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1003" y="436.9028">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="1011" y="452.0356">"label": "&lt;file_property_label&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1011" y="467.1685">"storage": "url",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="1011" y="482.3013">"key": "&lt;file_property_name&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1011" y="497.4341">"type": "file",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="1011" y="512.5669">"url": "/documents",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="1011" y="527.6997">"input": true</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1003" y="542.8325">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="995" y="557.9653">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="987" y="573.0981">}</text><polygon fill="#383838" points="987.5,590.1641,977.5,594.1641,987.5,598.1641,983.5,594.1641" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="981.5" x2="1563.5" y1="594.1641" y2="594.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="993.5" y="607.231">JSON-документ опису UI-форми</text><line style="stroke:#383838;stroke-width:1.0;" x1="976.5" x2="1018.5" y1="640.4297" y2="640.4297"/><line style="stroke:#383838;stroke-width:1.0;" x1="1018.5" x2="1018.5" y1="640.4297" y2="653.4297"/><line style="stroke:#383838;stroke-width:1.0;" x1="977.5" x2="1018.5" y1="653.4297" y2="653.4297"/><polygon fill="#383838" points="987.5,649.4297,977.5,653.4297,987.5,657.4297,983.5,653.4297" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402" x="983.5" y="635.3638">Пошук опису поля за key={fieldName} в мета-даних форми</text><path d="M10,668.4297 L74,668.4297 L74,675.4297 L64,685.4297 L10,685.4297 L10,668.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1060.5" x="10" y="668.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="681.4966">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="414" x="89" y="680.6401">[Опис поля з key={fieldName} не знайдено для форми задачі]</text><polygon fill="#383838" points="125.5,685.5625,115.5,689.5625,125.5,693.5625,121.5,689.5625" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="119.5" x2="965.5" y1="689.5625" y2="689.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="131.5" y="702.6294">403: Доступ заборонено</text><line style="stroke:#383838;stroke-width:1.0;" x1="976.5" x2="1018.5" y1="773.0938" y2="773.0938"/><line style="stroke:#383838;stroke-width:1.0;" x1="1018.5" x2="1018.5" y1="773.0938" y2="786.0938"/><line style="stroke:#383838;stroke-width:1.0;" x1="977.5" x2="1018.5" y1="786.0938" y2="786.0938"/><polygon fill="#383838" points="987.5,782.0938,977.5,786.0938,987.5,790.0938,983.5,786.0938" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311" x="983.5" y="737.7622">Формування композитного валідатора файлу</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="349" x="983.5" y="752.895">на базі опису правил для поля у мета-даних форми</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="983.5" y="768.0278">(File Pattern, File Maximum Size)</text><line style="stroke:#383838;stroke-width:1.0;" x1="976.5" x2="1018.5" y1="815.2266" y2="815.2266"/><line style="stroke:#383838;stroke-width:1.0;" x1="1018.5" x2="1018.5" y1="815.2266" y2="828.2266"/><line style="stroke:#383838;stroke-width:1.0;" x1="977.5" x2="1018.5" y1="828.2266" y2="828.2266"/><polygon fill="#383838" points="987.5,824.2266,977.5,828.2266,987.5,832.2266,983.5,828.2266" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="418" x="983.5" y="810.1606">Визначення ім'я, типу та розміру файлу &lt;filename, type, size&gt;</text><line style="stroke:#383838;stroke-width:1.0;" x1="976.5" x2="1018.5" y1="857.3594" y2="857.3594"/><line style="stroke:#383838;stroke-width:1.0;" x1="1018.5" x2="1018.5" y1="857.3594" y2="870.3594"/><line style="stroke:#383838;stroke-width:1.0;" x1="977.5" x2="1018.5" y1="870.3594" y2="870.3594"/><polygon fill="#383838" points="987.5,866.3594,977.5,870.3594,987.5,874.3594,983.5,870.3594" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="439" x="983.5" y="852.2935">Валідація &lt;filename, type, size&gt; згідно налаштованих обмежень</text><path d="M10,885.3594 L74,885.3594 L74,892.3594 L64,902.3594 L10,902.3594 L10,885.3594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1060.5" x="10" y="885.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="898.4263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="662" x="89" y="897.5698">[Порушені налаштовані адміністратором обмеження на завантаження файлів для файлового поля]</text><polygon fill="#383838" points="125.5,902.4922,115.5,906.4922,125.5,910.4922,121.5,906.4922" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="119.5" x2="965.5" y1="906.4922" y2="906.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="131.5" y="919.5591">422: Помилка валідації</text><line style="stroke:#383838;stroke-width:1.0;" x1="976.5" x2="1018.5" y1="959.7578" y2="959.7578"/><line style="stroke:#383838;stroke-width:1.0;" x1="1018.5" x2="1018.5" y1="959.7578" y2="972.7578"/><line style="stroke:#383838;stroke-width:1.0;" x1="977.5" x2="1018.5" y1="972.7578" y2="972.7578"/><polygon fill="#383838" points="987.5,968.7578,977.5,972.7578,987.5,976.7578,983.5,972.7578" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="983.5" y="954.6919">Збереження Ceph-об'єкта для файлу</text><line style="stroke:#383838;stroke-width:1.0;" x1="976.5" x2="1018.5" y1="1001.8906" y2="1001.8906"/><line style="stroke:#383838;stroke-width:1.0;" x1="1018.5" x2="1018.5" y1="1001.8906" y2="1014.8906"/><line style="stroke:#383838;stroke-width:1.0;" x1="977.5" x2="1018.5" y1="1014.8906" y2="1014.8906"/><polygon fill="#383838" points="987.5,1010.8906,977.5,1014.8906,987.5,1018.8906,983.5,1014.8906" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="420" x="983.5" y="996.8247">Підготовка відповіді з мета-даними збереженого документу</text><polygon fill="#383838" points="556.5,1022.8906,546.5,1026.8906,556.5,1030.8906,552.5,1026.8906" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="550.5" x2="970.5" y1="1026.8906" y2="1026.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333" x="562.5" y="1039.9575">200 OK: &lt;uuid, id, url, name, size, type, checksum&gt;</text><polygon fill="#383838" points="120.5,1052.0234,110.5,1056.0234,120.5,1060.0234,116.5,1056.0234" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="114.5" x2="539.5" y1="1056.0234" y2="1056.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333" x="126.5" y="1069.0903">200 OK: &lt;uuid, id, url, name, size, type, checksum&gt;</text><!--MD5=[78d3b4d3cf40256d885decf681761a78]
@startuml
skinparam monochrome true

participant "Клієнтський додаток\n кабінету користувача" as cabinet
participant "Kong \nAPI Management" as kong
participant "Сервіс \nцифрових документів" as digital_documents
participant "Сервіс \nвиконання \nбізнес-процесів" as bpms
participant "Сервіс \nмета-даних \nUI-форм" as form_provider
skinparam responseMessageBelowArrow true

title Валідація файлів при завантаженні через кабінет

activate cabinet
  cabinet -> kong: Запит на завантаження файлу: \nPOST "/documents/{processInstanceId}/{taskId}/{fieldName}"\n* Ідентифікатор сесії Kong; \n* Мета-атрибути файлу; \n* Бінарний контент файлу;
  activate kong
    kong -> digital_documents: Запит на завантаження файлу: \nPOST "/documents/{processInstanceId}/{taskId}/{fieldName}"\n* X-Access-Token; \n* Мета-атрибути файлу; \n* Бінарний контент файлу;
    activate digital_documents
      digital_documents -> bpms: Отримання зв'язаної з задачею UI-форми за {taskId}
      bpms - -> digital_documents: <formKey>
      digital_documents -> form_provider: Запит на отримання мета-даних UI-форми за {formKey}
      note right digital_documents
        {
          "components": [
            {
              "label": "<file_property_label>",
              "storage": "url",
              "key": "<file_property_name>",
              "type": "file",
              "url": "/documents",
              "input": true
            }
          ]
        }
      end note
      form_provider - -> digital_documents: JSON-документ опису UI-форми
      digital_documents -> digital_documents: Пошук опису поля за key={fieldName} в мета-даних форми
      alt Опис поля з key={fieldName} не знайдено для форми задачі
        digital_documents - -> cabinet: 403: Доступ заборонено
      end
      digital_documents -> digital_documents: Формування композитного валідатора файлу \nна базі опису правил для поля у мета-даних форми \n(File Pattern, File Maximum Size)
      digital_documents -> digital_documents: Визначення ім'я, типу та розміру файлу <filename, type, size>
      digital_documents -> digital_documents: Валідація <filename, type, size> згідно налаштованих обмежень
      alt Порушені налаштовані адміністратором обмеження на завантаження файлів для файлового поля
        digital_documents - -> cabinet: 422: Помилка валідації
      end
      digital_documents -> digital_documents: Збереження Ceph-об'єкта для файлу
      digital_documents -> digital_documents: Підготовка відповіді з мета-даними збереженого документу
    digital_documents - -> kong: 200 OK: <uuid, id, url, name, size, type, checksum>
    deactivate digital_documents
    kong -> cabinet: 200 OK: <uuid, id, url, name, size, type, checksum>
  deactivate kong
deactivate cabinet
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>