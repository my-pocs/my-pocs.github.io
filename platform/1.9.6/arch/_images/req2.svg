<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1188px" preserveAspectRatio="none" style="width:815px;height:1188px;background:#FFFFFF;" version="1.1" viewBox="0 0 815 1188" width="815px" zoomAndPan="magnify"><defs><filter height="300%" id="f1two3tdludkkt" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1two3tdludkkt)" height="966.9219" style="stroke:#A80036;stroke-width:1.0;" width="10" x="247" y="119.4297"/><rect fill="#E9967A" filter="url(#f1two3tdludkkt)" height="555.5234" style="stroke:#A80036;stroke-width:1.0;" width="10" x="252" y="494.6953"/><rect fill="#FFFFFF" filter="url(#f1two3tdludkkt)" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="344" x="217" y="134.4297"/><rect fill="#FFFFFF" filter="url(#f1two3tdludkkt)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="277" x="10" y="265.9609"/><rect fill="#FFFFFF" filter="url(#f1two3tdludkkt)" height="90.2031" style="stroke:#000000;stroke-width:2.0;" width="372.5" x="429" y="326.2266"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1.0;" width="372.5" x="429" y="372.4922"/><rect fill="#FFFFFF" filter="url(#f1two3tdludkkt)" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="344" x="217" y="514.6953"/><rect fill="#FFFFFF" filter="url(#f1two3tdludkkt)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="277" x="10" y="646.2266"/><rect fill="#FFFFFF" filter="url(#f1two3tdludkkt)" height="191.9297" style="stroke:#000000;stroke-width:2.0;" width="667" x="10" y="824.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="39" x2="39" y1="88.2969" y2="1104.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="252" x2="252" y1="88.2969" y2="1104.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="495" x2="495" y1="88.2969" y2="1104.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="617" x2="617" y1="88.2969" y2="1104.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="746.5" x2="746.5" y1="88.2969" y2="1104.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="20" y="84.9951">User</text><ellipse cx="39" cy="15" fill="#FEFECE" filter="url(#f1two3tdludkkt)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M39,23 L39,50 M26,31 L52,31 M39,50 L26,65 M39,50 L52,65 " fill="none" filter="url(#f1two3tdludkkt)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="20" y="1116.3467">User</text><ellipse cx="39" cy="1129.6484" fill="#FEFECE" filter="url(#f1two3tdludkkt)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M39,1137.6484 L39,1164.6484 M26,1145.6484 L52,1145.6484 M39,1164.6484 L26,1179.6484 M39,1164.6484 L52,1179.6484 " fill="none" filter="url(#f1two3tdludkkt)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1two3tdludkkt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="227" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="234" y="72.9951">RRM</text><rect fill="#FEFECE" filter="url(#f1two3tdludkkt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="227" y="1103.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="234" y="1123.3467">RRM</text><rect fill="#FEFECE" filter="url(#f1two3tdludkkt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="108" x="439" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="446" y="72.9951">Local Git repo</text><rect fill="#FEFECE" filter="url(#f1two3tdludkkt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="108" x="439" y="1103.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="446" y="1123.3467">Local Git repo</text><rect fill="#FEFECE" filter="url(#f1two3tdludkkt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="96" x="567" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="574" y="72.9951">Origin Gerrit</text><rect fill="#FEFECE" filter="url(#f1two3tdludkkt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="96" x="567" y="1103.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="574" y="1123.3467">Origin Gerrit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="702.5" y="84.9951">Counterpart</text><ellipse cx="747" cy="15" fill="#FEFECE" filter="url(#f1two3tdludkkt)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M747,23 L747,50 M734,31 L760,31 M747,50 L734,65 M747,50 L760,65 " fill="none" filter="url(#f1two3tdludkkt)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="702.5" y="1116.3467">Counterpart</text><ellipse cx="747" cy="1129.6484" fill="#FEFECE" filter="url(#f1two3tdludkkt)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M747,1137.6484 L747,1164.6484 M734,1145.6484 L760,1145.6484 M747,1164.6484 L734,1179.6484 M747,1164.6484 L760,1179.6484 " fill="none" filter="url(#f1two3tdludkkt)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FFFFFF" filter="url(#f1two3tdludkkt)" height="966.9219" style="stroke:#A80036;stroke-width:1.0;" width="10" x="247" y="119.4297"/><rect fill="#E9967A" filter="url(#f1two3tdludkkt)" height="555.5234" style="stroke:#A80036;stroke-width:1.0;" width="10" x="252" y="494.6953"/><polygon fill="#A80036" points="235,115.4297,245,119.4297,235,123.4297,239,119.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39" x2="241" y1="119.4297" y2="119.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="46" y="114.3638">update form/bp</text><path d="M217,134.4297 L420,134.4297 L420,141.4297 L410,151.4297 L217,151.4297 L217,134.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="344" x="217" y="134.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158" x="232" y="147.4966">Concurrent validation</text><polygon fill="#A80036" points="483,168.6953,493,172.6953,483,176.6953,487,172.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="257" x2="489" y1="172.6953" y2="172.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="264" y="167.6294">get file content</text><polygon fill="#A80036" points="268,197.8281,258,201.8281,268,205.8281,264,201.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="262" x2="494" y1="201.8281" y2="201.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="274" y="196.7622">file content</text><line style="stroke:#A80036;stroke-width:1.0;" x1="257" x2="299" y1="230.9609" y2="230.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299" x2="299" y1="230.9609" y2="243.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="258" x2="299" y1="243.9609" y2="243.9609"/><polygon fill="#A80036" points="268,239.9609,258,243.9609,268,247.9609,264,243.9609" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="264" y="225.895">compare etags</text><path d="M10,265.9609 L74,265.9609 L74,272.9609 L64,282.9609 L10,282.9609 L10,265.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="277" x="10" y="265.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="279.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="131" x="89" y="278.1714">[etags are different]</text><polygon fill="#A80036" points="50,300.2266,40,304.2266,50,308.2266,46,304.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="44" x2="246" y1="304.2266" y2="304.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="56" y="299.1606">HTTP 412 Precondition Failed</text><path d="M429,326.2266 L493,326.2266 L493,333.2266 L483,343.2266 L429,343.2266 L429,326.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:2.0;" width="372.5" x="429" y="326.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="444" y="339.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="215" x="508" y="338.437">[concurrent work in Admin Portal]</text><polygon fill="#A80036" points="506,360.4922,496,364.4922,506,368.4922,502,364.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="500" x2="746" y1="364.4922" y2="364.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="512" y="359.4263">updates form/bp</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="429" x2="801.5" y1="373.4922" y2="373.4922"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="170" x="434" y="383.7026">[concurrent work in Gerrit]</text><polygon fill="#A80036" points="628,404.4297,618,408.4297,628,412.4297,624,408.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="622" x2="746" y1="408.4297" y2="408.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="634" y="403.3638">updates form/bp</text><line style="stroke:#A80036;stroke-width:1.0;" x1="257" x2="299" y1="444.5625" y2="444.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299" x2="299" y1="444.5625" y2="457.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="258" x2="299" y1="457.5625" y2="457.5625"/><polygon fill="#A80036" points="268,453.5625,258,457.5625,268,461.5625,264,457.5625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="264" y="439.4966">do some side stuff</text><line style="stroke:#A80036;stroke-width:1.0;" x1="257" x2="304" y1="481.6953" y2="481.6953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304" x2="304" y1="481.6953" y2="494.6953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="263" x2="304" y1="494.6953" y2="494.6953"/><polygon fill="#A80036" points="273,490.6953,263,494.6953,273,498.6953,269,494.6953" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="269" y="476.6294">acquire lock</text><path d="M217,514.6953 L420,514.6953 L420,521.6953 L410,531.6953 L217,531.6953 L217,514.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="344" x="217" y="514.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158" x="232" y="527.7622">Concurrent validation</text><polygon fill="#A80036" points="483,548.9609,493,552.9609,483,556.9609,487,552.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262" x2="489" y1="552.9609" y2="552.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="269" y="547.895">get file content</text><polygon fill="#A80036" points="273,578.0938,263,582.0938,273,586.0938,269,582.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="267" x2="494" y1="582.0938" y2="582.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="279" y="577.0278">file content</text><line style="stroke:#A80036;stroke-width:1.0;" x1="262" x2="304" y1="611.2266" y2="611.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304" x2="304" y1="611.2266" y2="624.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="263" x2="304" y1="624.2266" y2="624.2266"/><polygon fill="#A80036" points="273,620.2266,263,624.2266,273,628.2266,269,624.2266" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="269" y="606.1606">compare etags</text><path d="M10,646.2266 L74,646.2266 L74,653.2266 L64,663.2266 L10,663.2266 L10,646.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="277" x="10" y="646.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="659.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="131" x="89" y="658.437">[etags are different]</text><polygon fill="#A80036" points="50,680.4922,40,684.4922,50,688.4922,46,684.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="44" x2="251" y1="684.4922" y2="684.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="56" y="679.4263">HTTP 412 Precondition Failed</text><polygon fill="#A80036" points="483,716.625,493,720.625,483,724.625,487,720.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262" x2="489" y1="720.625" y2="720.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="269" y="715.5591">write file content</text><polygon fill="#A80036" points="483,776.0234,493,780.0234,483,784.0234,487,780.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262" x2="489" y1="780.0234" y2="780.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="269" y="744.6919">git add</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="269" y="759.8247">git commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="269" y="774.9575">git push</text><polygon fill="#A80036" points="605,805.1563,615,809.1563,605,813.1563,609,809.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="495" x2="611" y1="809.1563" y2="809.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="502" y="804.0903">push changes</text><path d="M10,824.1563 L74,824.1563 L74,831.1563 L64,841.1563 L10,841.1563 L10,824.1563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="191.9297" style="stroke:#000000;stroke-width:2.0;" width="667" x="10" y="824.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="837.2231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="102" x="89" y="836.3667">[merge conflict]</text><polygon fill="#A80036" points="506,858.4219,496,862.4219,506,866.4219,502,862.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="500" x2="616" y1="862.4219" y2="862.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="512" y="857.356">merge conflicts</text><polygon fill="#A80036" points="273,887.5547,263,891.5547,273,895.5547,269,891.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="267" x2="494" y1="891.5547" y2="891.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="279" y="886.4888">merge conflicts</text><polygon fill="#A80036" points="483,916.6875,493,920.6875,483,924.6875,487,920.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262" x2="489" y1="920.6875" y2="920.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="269" y="915.6216">git fetch</text><polygon fill="#A80036" points="605,945.8203,615,949.8203,605,953.8203,609,949.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="495" x2="611" y1="949.8203" y2="949.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="502" y="944.7544">git fetch</text><polygon fill="#A80036" points="483,974.9531,493,978.9531,483,982.9531,487,978.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262" x2="489" y1="978.9531" y2="978.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="269" y="973.8872">hard reset on origin head branch</text><polygon fill="#A80036" points="50,1004.0859,40,1008.0859,50,1012.0859,46,1008.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="44" x2="251" y1="1008.0859" y2="1008.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="56" y="1003.02">HTTP 412 Precondition Failed</text><line style="stroke:#A80036;stroke-width:1.0;" x1="262" x2="304" y1="1049.2188" y2="1049.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304" x2="304" y1="1049.2188" y2="1062.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="257" x2="304" y1="1062.2188" y2="1062.2188"/><polygon fill="#A80036" points="267,1058.2188,257,1062.2188,267,1066.2188,263,1062.2188" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="269" y="1044.1528">release lock</text><polygon fill="#A80036" points="50,1082.3516,40,1086.3516,50,1090.3516,46,1086.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="44" x2="251" y1="1086.3516" y2="1086.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="56" y="1081.2856">ok</text><!--MD5=[afe2905349046f0c9348d32fd0a0b554]
@startuml
actor User as user
participant rrm as "RRM"
participant git as "Local Git repo"
participant gerrit as "Origin Gerrit"
actor counterpart as "Counterpart"

user -> rrm: update form/bp
activate rrm
group Concurrent validation
    rrm -> git: get file content
    git - -> rrm: file content
    rrm -> rrm: compare etags
end

alt etags are different
    rrm - -> user: HTTP 412 Precondition Failed
end

alt concurrent work in Admin Portal
    counterpart -> git: updates form/bp
else concurrent work in Gerrit
    counterpart -> gerrit: updates form/bp
end

rrm -> rrm: do some side stuff
rrm -> rrm: acquire lock
activate rrm #DarkSalmon
group Concurrent validation
    rrm -> git: get file content
    git - -> rrm: file content
    rrm -> rrm: compare etags
end
alt etags are different
    rrm - -> user: HTTP 412 Precondition Failed
end
rrm -> git: write file content

rrm -> git: git add\ngit commit\ngit push
git -> gerrit: push changes
alt merge conflict
    gerrit - -> git: merge conflicts
    git - -> rrm: merge conflicts
    rrm -> git: git fetch
    git -> gerrit: git fetch
    rrm -> git: hard reset on origin head branch
    rrm - -> user: HTTP 412 Precondition Failed
end
rrm -> rrm: release lock
deactivate rrm
rrm - -> user: ok
deactivate rrm
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>