<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="691px" preserveAspectRatio="none" style="width:982px;height:691px;background:#FFFFFF;" version="1.1" viewBox="0 0 982 691" width="982px" zoomAndPan="magnify"><defs><filter height="300%" id="f4meevtffehl3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="67" x2="67" y1="40.2969" y2="648.0156"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="225.5" x2="225.5" y1="40.2969" y2="648.0156"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="456" x2="456" y1="40.2969" y2="648.0156"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="657" x2="657" y1="40.2969" y2="648.0156"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="774" x2="774" y1="40.2969" y2="648.0156"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="898" x2="898" y1="40.2969" y2="648.0156"/><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="120" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="12" y="24.9951">ШБО Трембіта</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="120" x="5" y="647.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="12" y="667.0107">ШБО Трембіта</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="113" x="167.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="174.5" y="24.9951">ШБО Gateway</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="113" x="167.5" y="647.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="174.5" y="667.0107">ШБО Gateway</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="244" x="332" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="230" x="339" y="24.9951">Конфігурація зовнішніх клієнтів</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="244" x="332" y="647.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="230" x="339" y="667.0107">Конфігурація зовнішніх клієнтів</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="131" x="590" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="597" y="24.9951">OpenShift Secret</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="131" x="590" y="647.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="597" y="667.0107">OpenShift Secret</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="75" x="735" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="742" y="24.9951">Keycloak</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="75" x="735" y="647.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="742" y="667.0107">Keycloak</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="144" x="824" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="831" y="24.9951">Внутрішній сервіс</text><rect fill="#FEFECE" filter="url(#f4meevtffehl3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="144" x="824" y="647.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="831" y="667.0107">Внутрішній сервіс</text><path d="M130,55.2969 L130,155.2969 L318,155.2969 L318,65.2969 L308,55.2969 L130,55.2969 " fill="#FBFB77" filter="url(#f4meevtffehl3)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M308,55.2969 L308,65.2969 L318,65.2969 L308,55.2969 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="136" y="72.3638">Сервіс який налаштован</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="136" y="87.4966">для роботи з викликами</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="136" y="102.6294">з "ШБО Трембіта"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="136" y="117.7622">Має 2 реалізації: окремо</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="136" y="132.895">для бізнес-процесів та</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="136" y="148.0278">викликів фабрики даних</text><polygon fill="#A80036" points="214,227.625,224,231.625,214,235.625,218,231.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="220" y1="231.625" y2="231.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="74" y="203.8599">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="118" x="87" y="181.1606">Зовнішній виклик</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="209" y="181.1606"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="118" x="87" y="196.2935">subsystemCode</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="209" y="196.2935"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101" x="87" y="211.4263">memberClass</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="192" y="211.4263"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100" x="87" y="226.5591">memberCode</text><polygon fill="#A80036" points="444,302.1563,454,306.1563,444,310.1563,448,306.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="226" x2="450" y1="306.1563" y2="306.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="233" y="278.3911">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="246" y="255.6919">Отримання сервіс аккаунта</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="439" y="255.6919"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="118" x="246" y="270.8247">subsystemCode</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="368" y="270.8247"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101" x="246" y="285.9575">memberClass</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="351" y="285.9575"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100" x="246" y="301.0903">memberCode</text><polygon fill="#A80036" points="237,314.1563,227,318.1563,237,322.1563,233,318.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="231" x2="455" y1="318.1563" y2="318.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="338.7896">3</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="256" y="331.2231">serviceAccountName</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="414" y="331.2231"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183" x="256" y="346.356">serviceAccountSecretRef</text><polygon fill="#A80036" points="645.5,390.6875,655.5,394.6875,645.5,398.6875,649.5,394.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="226" x2="651.5" y1="394.6875" y2="394.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="233" y="382.0552">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="244" x="246" y="374.4888">Отримання паролю сервіс аккаунта</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="494" y="374.4888"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183" x="246" y="389.6216">serviceAccountSecretRef</text><polygon fill="#A80036" points="237,402.6875,227,406.6875,237,410.6875,233,406.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="231" x2="656.5" y1="406.6875" y2="406.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="419.7544">5</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87" x="256" y="419.7544">clientSecret</text><polygon fill="#A80036" points="762.5,479.2188,772.5,483.2188,762.5,487.2188,766.5,483.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="226" x2="768.5" y1="483.2188" y2="483.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="233" y="463.02">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="241" x="246" y="447.8872">Отримання токену сервіс аккаунта</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="491" y="447.8872"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="246" y="463.02">serviceAccountName</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="404" y="463.02"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87" x="246" y="478.1528">clientSecret</text><polygon fill="#A80036" points="237,491.2188,227,495.2188,237,499.2188,233,495.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="231" x2="773.5" y1="495.2188" y2="495.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="508.2856">7</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94" x="256" y="508.2856">accessToken</text><polygon fill="#A80036" points="886,567.75,896,571.75,886,575.75,890,571.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="226" x2="892" y1="571.75" y2="571.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="233" y="551.5513">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="113" x="246" y="536.4185">Цільовий виклик</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="363" y="536.4185"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="246" y="551.5513">Headers:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="246" y="566.6841">X-Access-Token:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94" x="355" y="566.6841">accessToken</text><polygon fill="#A80036" points="237,579.75,227,583.75,237,587.75,233,583.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="231" x2="897" y1="583.75" y2="583.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="596.8169">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="256" y="596.8169">Відповідь</text><polygon fill="#A80036" points="78,608.8828,68,612.8828,78,616.8828,74,612.8828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="72" x2="225" y1="612.8828" y2="612.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="84" y="625.9497">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="106" y="625.9497">Відповідь</text><!--MD5=[02b39d57e34d2382e51aeb27520d038a]
@startuml
participant "ШБО Трембіта" as trembita
participant "ШБО Gateway" as gateway
participant "Конфігурація зовнішніх клієнтів" as config
participant "OpenShift Secret" as secret
participant "Keycloak" as keycloak
participant "Внутрішній сервіс" as service

autonumber
skinparam responseMessageBelowArrow true

note over gateway
Сервіс який налаштован
для роботи з викликами
з "ШБО Трембіта"
Має 2 реалізації: окремо
для бізнес-процесів та
викликів фабрики даних
end note

trembita -> gateway: __Зовнішній виклик__ \n**subsystemCode** \n**memberClass** \n**memberCode**

gateway -> config: __Отримання сервіс аккаунта__ \n**subsystemCode** \n**memberClass** \n**memberCode**

config - -> gateway: **serviceAccountName** \n**serviceAccountSecretRef**

gateway -> secret: __Отримання паролю сервіс аккаунта__ \n**serviceAccountSecretRef**

secret - -> gateway: **clientSecret**

gateway -> keycloak: __Отримання токену сервіс аккаунта__ \n**serviceAccountName** \n**clientSecret**

keycloak - -> gateway: **accessToken**

gateway -> service: __Цільовий виклик__ \nHeaders: \nX-Access-Token: **accessToken**

service - -> gateway: Відповідь

gateway - -> trembita: Відповідь
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>