<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="860px" preserveAspectRatio="none" style="width:1276px;height:860px;background:#FFFFFF;" version="1.1" viewBox="0 0 1276 860" width="1276px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="848.2344" style="stroke:#2688D4;stroke-width:1.0;" width="697" x="369" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="316" x="559.5" y="18.0669">Сервіс виконання бізнес-процесів (bpms)</text><rect fill="#FFFFFF" height="640.9492" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="608.5" y="144.6914"/><rect fill="#FFFFFF" height="299.9922" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="873.5" y="471.6484"/><rect fill="#FFFFFF" height="72.2656" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="996.5" y="685.375"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="422" x2="422" y1="72.7266" y2="803.6406"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="613.5" x2="613.5" y1="72.7266" y2="803.6406"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="878.5" x2="878.5" y1="72.7266" y2="803.6406"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1001" x2="1001" y1="72.7266" y2="803.6406"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1196" x2="1196" y1="72.7266" y2="803.6406"/><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="99" x="373" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="400" y="45.1279">BPMN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="380" y="61.4248">Core Engine</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="99" x="373" y="802.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="400" y="822.6357">BPMN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="380" y="838.9326">Core Engine</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="170" x="528.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="535.5" y="45.1279">Send User Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="582" y="61.4248">Delegate</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="170" x="528.5" y="802.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="535.5" y="822.6357">Send User Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="582" y="838.9326">Delegate</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="94" x="831.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="838.5" y="45.1279">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="853.5" y="61.4248">Facade</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="94" x="831.5" y="802.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="838.5" y="822.6357">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="853.5" y="838.9326">Facade</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="121" x="941" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="961.5" y="45.1279">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="948" y="61.4248">Event Publisher</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="121" x="941" y="802.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="961.5" y="822.6357">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="948" y="838.9326">Event Publisher</text><path d="M1129,30.1328 L1264,30.1328 C1269,30.1328 1269,51.4297 1269,51.4297 C1269,51.4297 1269,72.7266 1264,72.7266 L1129,72.7266 C1124,72.7266 1124,51.4297 1124,51.4297 C1124,51.4297 1124,30.1328 1129,30.1328 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:2.0;"/><path d="M1264,30.1328 C1259,30.1328 1259,51.4297 1259,51.4297 C1259,72.7266 1264,72.7266 1264,72.7266 " fill="none" style="stroke:#2688D4;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="1129" y="48.1279">'user-notifications'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1154" y="64.4248">Kafka Topic</text><path d="M1129,802.6406 L1264,802.6406 C1269,802.6406 1269,823.9375 1269,823.9375 C1269,823.9375 1269,845.2344 1264,845.2344 L1129,845.2344 C1124,845.2344 1124,823.9375 1124,823.9375 C1124,823.9375 1124,802.6406 1129,802.6406 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:2.0;"/><path d="M1264,802.6406 C1259,802.6406 1259,823.9375 1259,823.9375 C1259,845.2344 1264,845.2344 1264,845.2344 " fill="none" style="stroke:#2688D4;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="1129" y="820.6357">'user-notifications'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1154" y="836.9326">Kafka Topic</text><rect fill="#FFFFFF" height="640.9492" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="608.5" y="144.6914"/><rect fill="#FFFFFF" height="299.9922" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="873.5" y="471.6484"/><rect fill="#FFFFFF" height="72.2656" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="996.5" y="685.375"/><polygon fill="#2688D4" points="596.5,140.6914,606.5,144.6914,596.5,148.6914,600.5,144.6914" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="422.5" x2="602.5" y1="144.6914" y2="144.6914"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="429.5" y="124.4927">Обробка задачі</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="429.5" y="139.6255">відправки повідомлення</text><path d="M5,87.7266 L5,172.7266 L418,172.7266 L418,97.7266 L408,87.7266 L5,87.7266 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.0;"/><path d="M408,87.7266 L408,97.7266 L418,97.7266 L408,87.7266 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="11" y="104.7935">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304" x="19" y="119.9263">"notificationRecipient": "{notificationRecipient}",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="19" y="135.0591">"notificationTemplate": "{notificationTemplate}",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384" x="19" y="150.1919">"notificationTemplateModel": "{notificationTemplateModel}",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="11" y="165.3247">}</text><line style="stroke:#2688D4;stroke-width:1.0;" x1="618.5" x2="660.5" y1="229.7891" y2="229.7891"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="660.5" x2="660.5" y1="229.7891" y2="242.7891"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="619.5" x2="660.5" y1="242.7891" y2="242.7891"/><polygon fill="#2688D4" points="629.5,238.7891,619.5,242.7891,629.5,246.7891,625.5,242.7891" style="stroke:#2688D4;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="625.5" y="194.4575">Обробка вхідних параметрів</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="625.5" y="209.5903">та формування запиту</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="625.5" y="224.7231">на відправку повідомлення</text><polygon fill="#2688D4" points="861.5,467.6484,871.5,471.6484,861.5,475.6484,865.5,471.6484" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="618.5" x2="867.5" y1="471.6484" y2="471.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="625.5" y="436.3169">Запит на відправку повідомлення</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="625.5" y="451.4497">згідно преференцій користувача</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="625.5" y="466.5825">за каналами зв'язку</text><path d="M164,255.7891 L164,643.7891 L603,643.7891 L603,265.7891 L593,255.7891 L164,255.7891 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.0;"/><path d="M593,255.7891 L593,265.7891 L603,265.7891 L593,255.7891 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="170" y="272.856">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="178" y="287.9888">"context": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="186" y="303.1216">"system": "Low-code Platform",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="186" y="318.2544">"application": "&lt;bpms.app.name&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="186" y="333.3872">"businessProcess": "{businessProcess}",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402" x="186" y="348.52">"businessProcessDefinitionId": "{businessProcessDefinitionId}",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="398" x="186" y="363.6528">"businessProcessInstanceId": "{businessProcessInstanceId}}",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="186" y="378.7856">"businessActivity": "{businessActivity}}",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378" x="186" y="393.9185">"businessActivityInstanceId": "{businessActivityInstanceId}"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="178" y="409.0513">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="178" y="424.1841">"notification": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="186" y="439.3169">"templateName": "{notificationTemplate}"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="178" y="454.4497">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="178" y="469.5825">"recipients": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="186" y="484.7153">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="194" y="499.8481">"id": "{notificationRecipient}",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="198" y="514.981">"parameters": [ // {notificationTemplateModel}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="206" y="530.1138">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="222" y="545.2466">"key": "&lt;key&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="222" y="560.3794">"value": "&lt;value&gt;"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="206" y="575.5122">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="198" y="590.645">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="186" y="605.7778">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="178" y="620.9106">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="170" y="636.0435">}</text><polygon fill="#2688D4" points="984.5,681.375,994.5,685.375,984.5,689.375,988.5,685.375" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="883.5" x2="990.5" y1="685.375" y2="685.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="890.5" y="665.1763">Відправка</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="890.5" y="680.3091">повідомлення</text><polygon fill="#2688D4" points="1184.5,725.6406,1194.5,729.6406,1184.5,733.6406,1188.5,729.6406" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="1006.5" x2="1190.5" y1="729.6406" y2="729.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="1013.5" y="709.4419">Публікація запиту на</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="1013.5" y="724.5747">відправку повідомлення</text><polygon fill="#2688D4" points="1017.5,739.6406,1007.5,743.6406,1017.5,747.6406,1013.5,743.6406" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1011.5" x2="1195.5" y1="743.6406" y2="743.6406"/><polygon fill="#2688D4" points="894.5,753.6406,884.5,757.6406,894.5,761.6406,890.5,757.6406" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="888.5" x2="1000.5" y1="757.6406" y2="757.6406"/><polygon fill="#2688D4" points="629.5,767.6406,619.5,771.6406,629.5,775.6406,625.5,771.6406" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="623.5" x2="877.5" y1="771.6406" y2="771.6406"/><polygon fill="#2688D4" points="433.5,781.6406,423.5,785.6406,433.5,789.6406,429.5,785.6406" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="427.5" x2="612.5" y1="785.6406" y2="785.6406"/><!--MD5=[11344e5da2c88d46b5f57b8ddef2ffaf]
@startuml
skinparam shadowing false
skinparam DatabaseBackgroundColor white
skinparam DatabaseBorderColor #2688d4
skinparam QueueBackgroundColor white
skinparam QueueBorderColor #2688d4
skinparam NoteBackgroundColor white
skinparam NoteBorderColor #2688d4
skinparam sequence {
    ArrowColor #2688d4
    ActorBorderColor #2688d4
    LifeLineBorderColor #2688d4
    ParticipantBorderColor #2688d4
    ParticipantBackgroundColor white
    BoxBorderColor #2688d4
    BoxBackgroundColor white
}

box "Сервіс виконання бізнес-процесів (bpms)"
    participant "BPMN \nCore Engine" as engine
    participant "Send User Notification \nDelegate" as send_notification_delegate
    participant "Notification \nFacade" as notification_facade
    participant "Notification \nEvent Publisher" as notification_kafka_publisher
end box

queue "'user-notifications'\n Kafka Topic" as user_notifications_kafka_topic

engine -> send_notification_delegate: Обробка задачі \nвідправки повідомлення
note left
  {
    "notificationRecipient": "{notificationRecipient}",
    "notificationTemplate": "{notificationTemplate}",
    "notificationTemplateModel": "{notificationTemplateModel}",
  }
end note
activate send_notification_delegate
  send_notification_delegate -> send_notification_delegate: Обробка вхідних параметрів \nта формування запиту \nна відправку повідомлення
  send_notification_delegate -> notification_facade: Запит на відправку повідомлення \nзгідно преференцій користувача \nза каналами зв'язку
  note left
   {
     "context": {
       "system": "Low-code Platform",
       "application": "<bpms.app.name>",
       "businessProcess": "{businessProcess}",
       "businessProcessDefinitionId": "{businessProcessDefinitionId}",
       "businessProcessInstanceId": "{businessProcessInstanceId}}",
       "businessActivity": "{businessActivity}}",
       "businessActivityInstanceId": "{businessActivityInstanceId}"
     },
     "notification": {
       "templateName": "{notificationTemplate}"
     },
     "recipients": [
       {
         "id": "{notificationRecipient}",
          "parameters": [ // {notificationTemplateModel}
            {
                "key": "<key>",
                "value": "<value>"
            }
          ]
       }
     ]
   }
  end note
  activate notification_facade
    notification_facade -> notification_kafka_publisher: Відправка \nповідомлення
    activate notification_kafka_publisher
      notification_kafka_publisher -> user_notifications_kafka_topic: Публікація запиту на \nвідправку повідомлення
      user_notifications_kafka_topic - -> notification_kafka_publisher
      notification_kafka_publisher - -> notification_facade
    deactivate notification_kafka_publisher
    notification_facade - -> send_notification_delegate
  deactivate notification_facade
  send_notification_delegate - -> engine
deactivate send_notification_delegate
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>