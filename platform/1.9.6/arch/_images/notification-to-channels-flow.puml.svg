<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2483px" preserveAspectRatio="none" style="width:2794px;height:2483px;background:#FFFFFF;" version="1.1" viewBox="0 0 2794 2483" width="2794px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="2471.6797" style="stroke:#2688D4;stroke-width:1.0;" width="1197" x="522" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="233" x="1004" y="18.0669">Сервіс відправки повідомлень</text><rect fill="#FFFFFF" height="975.7188" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="586.5" y="366.5859"/><rect fill="#FFFFFF" height="763.2227" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="586.5" y="1622.8633"/><rect fill="#FFFFFF" height="746.8594" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="877.5" y="595.4453"/><rect fill="#FFFFFF" height="526.7969" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="877.5" y="1859.2891"/><rect fill="#FFFFFF" height="1191.5781" style="stroke:#000000;stroke-width:2.0;" width="2768" x="9" y="143.7266"/><rect fill="#FFFFFF" height="340.4609" style="stroke:#000000;stroke-width:2.0;" width="1592.5" x="815.5" y="784.2422"/><rect fill="#FFFFFF" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1245" x="1077" y="837.5078"/><rect fill="#FFFFFF" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1496.5" x="825.5" y="1071.4375"/><rect fill="#FFFFFF" height="116.2031" style="stroke:none;stroke-width:1.0;" width="2768" x="9" y="1219.1016"/><rect fill="#FFFFFF" height="986.6484" style="stroke:#000000;stroke-width:2.0;" width="2672" x="105" y="1392.4375"/><rect fill="#FFFFFF" height="31.1328" style="stroke:#000000;stroke-width:2.0;" width="1245" x="1077" y="1917.4219"/><rect fill="#FFFFFF" height="31.1328" style="stroke:#000000;stroke-width:2.0;" width="1496.5" x="825.5" y="2137.3516"/><rect fill="#FFFFFF" height="116.2031" style="stroke:none;stroke-width:1.0;" width="2672" x="105" y="2262.8828"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="428" x2="428" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="591" x2="591" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="882.5" x2="882.5" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1164" x2="1164" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1329" x2="1329" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1483" x2="1483" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1637" x2="1637" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1829" x2="1829" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2053" x2="2053" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2242" x2="2242" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2360" x2="2360" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2496" x2="2496" y1="83.5938" y2="2396.0859"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2680" x2="2680" y1="83.5938" y2="2396.0859"/><path d="M361,41 L496,41 C501,41 501,62.2969 501,62.2969 C501,62.2969 501,83.5938 496,83.5938 L361,83.5938 C356,83.5938 356,62.2969 356,62.2969 C356,62.2969 356,41 361,41 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:2.0;"/><path d="M496,41 C491,41 491,62.2969 491,62.2969 C491,83.5938 496,83.5938 496,83.5938 " fill="none" style="stroke:#2688D4;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="361" y="58.9951">'user-notifications'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="386" y="75.292">Kafka Topic</text><path d="M361,2395.0859 L496,2395.0859 C501,2395.0859 501,2416.3828 501,2416.3828 C501,2416.3828 501,2437.6797 496,2437.6797 L361,2437.6797 C356,2437.6797 356,2416.3828 356,2416.3828 C356,2416.3828 356,2395.0859 361,2395.0859 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:2.0;"/><path d="M496,2395.0859 C491,2395.0859 491,2416.3828 491,2416.3828 C491,2437.6797 496,2437.6797 496,2437.6797 " fill="none" style="stroke:#2688D4;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="361" y="2413.0811">'user-notifications'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="386" y="2429.3779">Kafka Topic</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="131" x="526" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="551.5" y="55.9951">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="533" y="72.292">Event Subscriber</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="131" x="526" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="551.5" y="2415.0811">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="533" y="2431.3779">Event Subscriber</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="94" x="835.5" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="842.5" y="55.9951">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="857.5" y="72.292">Service</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="94" x="835.5" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="842.5" y="2415.0811">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="857.5" y="2431.3779">Service</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="155" x="1087" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1094" y="55.9951">Channel Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1131" y="72.292">Validators</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="155" x="1087" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1094" y="2415.0811">Channel Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1131" y="2431.3779">Validators</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="155" x="1252" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1259" y="55.9951">Channel Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1294" y="72.292">Producers</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="155" x="1252" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1259" y="2415.0811">Channel Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1294" y="2431.3779">Producers</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="133" x="1417" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="1443.5" y="55.9951">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="1424" y="72.292">Template Service</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="133" x="1417" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="1443.5" y="2415.0811">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="1424" y="2431.3779">Template Service</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="155" x="1560" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1567" y="55.9951">Channel Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1601.5" y="72.292">Publishers</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="155" x="1560" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1567" y="2415.0811">Channel Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1601.5" y="2431.3779">Publishers</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="208" x="1725" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1803.5" y="55.9951">Сервіс</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="1732" y="72.292">налаштувань користувачів</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="208" x="1725" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1803.5" y="2415.0811">Сервіс</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="1732" y="2431.3779">налаштувань користувачів</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="220" x="1943" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="1986" y="55.9951">Сервіс управління</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="206" x="1950" y="72.292">користувачами та доступом</text><rect fill="#FFFFFF" height="46.5938" style="stroke:#2688D4;stroke-width:1.5;" width="220" x="1943" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="1986" y="2415.0811">Сервіс управління</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="206" x="1950" y="2431.3779">користувачами та доступом</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#2688D4;stroke-width:1.5;" width="139" x="2173" y="52.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="2180" y="72.292">Сервіс логування</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#2688D4;stroke-width:1.5;" width="139" x="2173" y="2395.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="2180" y="2415.0811">Сервіс логування</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="2322" y="63.9951">Сховище</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="2323" y="80.292">шаблонів</text><path d="M2342,15 C2342,5 2360,5 2360,5 C2360,5 2378,5 2378,15 L2378,41 C2378,51 2360,51 2360,51 C2360,51 2342,51 2342,41 L2342,15 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.5;"/><path d="M2342,15 C2342,25 2360,25 2360,25 C2360,25 2378,25 2378,15 " fill="none" style="stroke:#2688D4;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="2322" y="2408.0811">Сховище</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="2323" y="2424.3779">шаблонів</text><path d="M2342,2437.6797 C2342,2427.6797 2360,2427.6797 2360,2427.6797 C2360,2427.6797 2378,2427.6797 2378,2437.6797 L2378,2463.6797 C2378,2473.6797 2360,2473.6797 2360,2473.6797 C2360,2473.6797 2342,2473.6797 2342,2463.6797 L2342,2437.6797 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.5;"/><path d="M2342,2437.6797 C2342,2447.6797 2360,2447.6797 2360,2447.6797 C2360,2447.6797 2378,2447.6797 2378,2437.6797 " fill="none" style="stroke:#2688D4;stroke-width:1.5;"/><path d="M2413,41 L2579,41 C2584,41 2584,62.2969 2584,62.2969 C2584,62.2969 2584,83.5938 2579,83.5938 L2413,83.5938 C2408,83.5938 2408,62.2969 2408,62.2969 C2408,62.2969 2408,41 2413,41 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:2.0;"/><path d="M2579,41 C2574,41 2574,62.2969 2574,62.2969 C2574,83.5938 2579,83.5938 2579,83.5938 " fill="none" style="stroke:#2688D4;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2413" y="58.9951">'user-notifications.DLT'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="2453.5" y="75.292">Kafka Topic</text><path d="M2413,2395.0859 L2579,2395.0859 C2584,2395.0859 2584,2416.3828 2584,2416.3828 C2584,2416.3828 2584,2437.6797 2579,2437.6797 L2413,2437.6797 C2408,2437.6797 2408,2416.3828 2408,2416.3828 C2408,2416.3828 2408,2395.0859 2413,2395.0859 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:2.0;"/><path d="M2579,2395.0859 C2574,2395.0859 2574,2416.3828 2574,2416.3828 C2574,2437.6797 2579,2437.6797 2579,2437.6797 " fill="none" style="stroke:#2688D4;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2413" y="2413.0811">'user-notifications.DLT'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="2453.5" y="2429.3779">Kafka Topic</text><path d="M2599,41 L2762,41 C2767,41 2767,62.2969 2767,62.2969 C2767,62.2969 2767,83.5938 2762,83.5938 L2599,83.5938 C2594,83.5938 2594,62.2969 2594,62.2969 C2594,62.2969 2594,41 2599,41 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:2.0;"/><path d="M2762,41 C2757,41 2757,62.2969 2757,62.2969 C2757,83.5938 2762,83.5938 2762,83.5938 " fill="none" style="stroke:#2688D4;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="2599" y="58.9951">'*-channel-notification'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="2638" y="75.292">Kafka Topic</text><path d="M2599,2395.0859 L2762,2395.0859 C2767,2395.0859 2767,2416.3828 2767,2416.3828 C2767,2416.3828 2767,2437.6797 2762,2437.6797 L2599,2437.6797 C2594,2437.6797 2594,2416.3828 2594,2416.3828 C2594,2416.3828 2594,2395.0859 2599,2395.0859 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:2.0;"/><path d="M2762,2395.0859 C2757,2395.0859 2757,2416.3828 2757,2416.3828 C2757,2437.6797 2762,2437.6797 2762,2437.6797 " fill="none" style="stroke:#2688D4;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="2599" y="2413.0811">'*-channel-notification'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="2638" y="2429.3779">Kafka Topic</text><rect fill="#FFFFFF" height="975.7188" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="586.5" y="366.5859"/><rect fill="#FFFFFF" height="763.2227" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="586.5" y="1622.8633"/><rect fill="#FFFFFF" height="746.8594" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="877.5" y="595.4453"/><rect fill="#FFFFFF" height="526.7969" style="stroke:#2688D4;stroke-width:1.0;" width="10" x="877.5" y="1859.2891"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2787" x="0" y="114.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2787" y1="114.1602" y2="114.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2787" y1="117.1602" y2="117.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="448" x="1169.5" y="103.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="429" x="1175.5" y="119.6606">Відправка повідомлень за преференціями користувача</text><path d="M9,143.7266 L73,143.7266 L73,150.7266 L63,160.7266 L9,160.7266 L9,143.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1191.5781" style="stroke:#000000;stroke-width:2.0;" width="2768" x="9" y="143.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="24" y="156.7935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="174" x="88" y="155.937">[Відправка повідомлення]</text><polygon fill="#2688D4" points="439.5,362.5859,429.5,366.5859,439.5,370.5859,435.5,366.5859" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="433.5" x2="585.5" y1="366.5859" y2="366.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="445.5" y="361.52">Зчитування події</text><path d="M19,165.8594 L19,553.8594 L423,553.8594 L423,175.8594 L413,165.8594 L19,165.8594 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.0;"/><path d="M413,165.8594 L413,175.8594 L423,175.8594 L413,165.8594 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="25" y="182.9263">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="33" y="198.0591">"context": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="41" y="213.1919">"system": "Low-code Platform",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="41" y="228.3247">"application": "&lt;bpms.app.name&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="41" y="243.4575">"businessProcess": "&lt;optional&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282" x="41" y="258.5903">"businessProcessDefinitionId": "&lt;optional&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276" x="41" y="273.7231">"businessProcessInstanceId": "&lt;optional&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="41" y="288.856">"businessActivity": "&lt;optional&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268" x="41" y="303.9888">"businessActivityInstanceId": "&lt;optional&gt;"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="33" y="319.1216">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="33" y="334.2544">"notification": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367" x="41" y="349.3872">"templateName": "&lt;notification template unique name&gt;"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="33" y="364.52">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="33" y="379.6528">"recipients": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="41" y="394.7856">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="49" y="409.9185">"id": "&lt;Ідентифікатор користувача&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="49" y="425.0513">"parameters": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="57" y="440.1841">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="73" y="455.3169">"key": "&lt;key&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="73" y="470.4497">"value": "&lt;value&gt;"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="57" y="485.5825">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="49" y="500.7153">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="41" y="515.8481">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="33" y="530.981">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="25" y="546.1138">}</text><polygon fill="#2688D4" points="865.5,591.4453,875.5,595.4453,865.5,599.4453,869.5,595.4453" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="596.5" x2="871.5" y1="595.4453" y2="595.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="603.5" y="575.2466">Відправка повідомлення</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="603.5" y="590.3794">користувачу &lt;recipient&gt;</text><polygon fill="#2688D4" points="1817,635.7109,1827,639.7109,1817,643.7109,1821,639.7109" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1823" y1="639.7109" y2="639.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="894.5" y="619.5122">Читання налаштувань користувача</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="894.5" y="634.645">(</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181" x="899.5" y="634.645">username = &lt;recipient&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="1080.5" y="634.645">)</text><polygon fill="#2688D4" points="898.5,664.8438,888.5,668.8438,898.5,672.8438,894.5,668.8438" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="1828" y1="668.8438" y2="668.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295" x="904.5" y="663.7778">Обрані канали зв'язку з їх налаштуваннями</text><polygon fill="#2688D4" points="2041,693.9766,2051,697.9766,2041,701.9766,2045,697.9766" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="2047" y1="697.9766" y2="697.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="894.5" y="692.9106">Читання атрибутів користувача</text><polygon fill="#2688D4" points="898.5,723.1094,888.5,727.1094,898.5,731.1094,894.5,727.1094" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="2052" y1="727.1094" y2="727.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269" x="904.5" y="722.0435">Атрибути користувача: РНОКПП, тощо.</text><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="929.5" y1="756.2422" y2="756.2422"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="929.5" x2="929.5" y1="756.2422" y2="769.2422"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="888.5" x2="929.5" y1="769.2422" y2="769.2422"/><polygon fill="#2688D4" points="898.5,765.2422,888.5,769.2422,898.5,773.2422,894.5,769.2422" style="stroke:#2688D4;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="894.5" y="751.1763">Визначення каналів зв'язку (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57" x="1090.5" y="751.1763">channel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="1147.5" y="751.1763">)</text><path d="M815.5,784.2422 L892.5,784.2422 L892.5,791.2422 L882.5,801.2422 L815.5,801.2422 L815.5,784.2422 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="340.4609" style="stroke:#000000;stroke-width:2.0;" width="1592.5" x="815.5" y="784.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="830.5" y="797.3091">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="348" x="907.5" y="796.4526">[Обробка повідомлення для кожного каналу зв'язку]</text><polygon fill="#2688D4" points="1152.5,818.5078,1162.5,822.5078,1152.5,826.5078,1156.5,822.5078" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1158.5" y1="822.5078" y2="822.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="894.5" y="817.4419">Валідація повідомлення</text><path d="M1077,837.5078 L1141,837.5078 L1141,844.5078 L1131,854.5078 L1077,854.5078 L1077,837.5078 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1245" x="1077" y="837.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="1092" y="850.5747">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="131" x="1156" y="849.7183">[Помилка валідації]</text><polygon fill="#2688D4" points="2230.5,871.7734,2240.5,875.7734,2230.5,879.7734,2234.5,875.7734" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="1164.5" x2="2236.5" y1="875.7734" y2="875.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="1171.5" y="870.7075">Логування помилки</text><polygon fill="#2688D4" points="898.5,892.7734,888.5,896.7734,898.5,900.7734,894.5,896.7734" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="1163.5" y1="896.7734" y2="896.7734"/><polygon fill="#2688D4" points="1471.5,937.0391,1481.5,941.0391,1471.5,945.0391,1475.5,941.0391" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1477.5" y1="941.0391" y2="941.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="894.5" y="920.8403">Запит на отримання шаблону для каналу зв'язку</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="894.5" y="935.9731">(у випадку з diia - створення шаблону)</text><polygon fill="#2688D4" points="2348,966.1719,2358,970.1719,2348,974.1719,2352,970.1719" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="1483.5" x2="2354" y1="970.1719" y2="970.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="1490.5" y="965.106">Отримання шаблону</text><polygon fill="#2688D4" points="1494.5,980.1719,1484.5,984.1719,1494.5,988.1719,1490.5,984.1719" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1488.5" x2="2359" y1="984.1719" y2="984.1719"/><polygon fill="#2688D4" points="898.5,994.1719,888.5,998.1719,898.5,1002.1719,894.5,998.1719" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="1482.5" y1="998.1719" y2="998.1719"/><polygon fill="#2688D4" points="1317.5,1023.3047,1327.5,1027.3047,1317.5,1031.3047,1321.5,1027.3047" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1323.5" y1="1027.3047" y2="1027.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305" x="894.5" y="1022.2388">Створення повідомлення для каналу зв'язку</text><polygon fill="#2688D4" points="898.5,1052.4375,888.5,1056.4375,898.5,1060.4375,894.5,1056.4375" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="1328.5" y1="1056.4375" y2="1056.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="904.5" y="1051.3716">Повідомлення для каналів зв'язку</text><path d="M825.5,1071.4375 L889.5,1071.4375 L889.5,1078.4375 L879.5,1088.4375 L825.5,1088.4375 L825.5,1071.4375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1496.5" x="825.5" y="1071.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="840.5" y="1084.5044">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="365" x="904.5" y="1083.6479">[Помилка створення повідомлення з шаблону і моделі]</text><polygon fill="#2688D4" points="2230.5,1105.7031,2240.5,1109.7031,2230.5,1113.7031,2234.5,1109.7031" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="2236.5" y1="1109.7031" y2="1109.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="894.5" y="1104.6372">Логування помилки</text><polygon fill="#2688D4" points="1625.5,1148.8359,1635.5,1152.8359,1625.5,1156.8359,1629.5,1152.8359" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1631.5" y1="1152.8359" y2="1152.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353" x="894.5" y="1147.77">Запит на відправку повідомлень до каналів зв'язку</text><polygon fill="#2688D4" points="2668.5,1177.9688,2678.5,1181.9688,2668.5,1185.9688,2672.5,1181.9688" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="1637.5" x2="2674.5" y1="1181.9688" y2="1181.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="1644.5" y="1176.9028">Публікація в топік каналу зв'язку</text><polygon fill="#2688D4" points="439.5,1207.1016,429.5,1211.1016,439.5,1215.1016,435.5,1211.1016" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="433.5" x2="585.5" y1="1211.1016" y2="1211.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="445.5" y="1206.0356">Подію опрацьовано</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="9" x2="2777" y1="1220.1016" y2="1220.1016"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="199" x="14" y="1230.312">[Повідомлення не оброблене]</text><polygon fill="#2688D4" points="2230.5,1251.0391,2240.5,1255.0391,2230.5,1259.0391,2234.5,1255.0391" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="2236.5" y1="1255.0391" y2="1255.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="894.5" y="1249.9731">Логування помилки</text><polygon fill="#2688D4" points="2484,1280.1719,2494,1284.1719,2484,1288.1719,2488,1284.1719" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="2490" y1="1284.1719" y2="1284.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323" x="894.5" y="1279.106">Збереження повідомлення до Dead-Letter Topic</text><polygon fill="#2688D4" points="898.5,1294.1719,888.5,1298.1719,898.5,1302.1719,894.5,1298.1719" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="2495" y1="1298.1719" y2="1298.1719"/><polygon fill="#2688D4" points="439.5,1323.3047,429.5,1327.3047,439.5,1331.3047,435.5,1327.3047" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="433.5" x2="585.5" y1="1327.3047" y2="1327.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="445.5" y="1322.2388">Подію опрацьовано</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2787" x="0" y="1362.8711"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2787" y1="1362.8711" y2="1362.8711"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2787" y1="1365.8711" y2="1365.8711"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="388" x="1199.5" y="1352.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="369" x="1205.5" y="1368.3716">Відправка повідомлень за визначеним каналом</text><path d="M105,1392.4375 L169,1392.4375 L169,1399.4375 L159,1409.4375 L105,1409.4375 L105,1392.4375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="986.6484" style="stroke:#000000;stroke-width:2.0;" width="2672" x="105" y="1392.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="120" y="1405.5044">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="174" x="184" y="1404.6479">[Відправка повідомлення]</text><polygon fill="#2688D4" points="439.5,1618.8633,429.5,1622.8633,439.5,1626.8633,435.5,1622.8633" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="433.5" x2="585.5" y1="1622.8633" y2="1622.8633"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="445.5" y="1617.7974">Зчитування події</text><path d="M115,1414.5703 L115,1817.5703 L423,1817.5703 L423,1424.5703 L413,1414.5703 L115,1414.5703 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.0;"/><path d="M413,1414.5703 L413,1424.5703 L423,1424.5703 L413,1414.5703 " fill="#FFFFFF" style="stroke:#2688D4;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="121" y="1431.6372">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="129" y="1446.77">"context": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="137" y="1461.9028">"system": "Low-code Platform",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="137" y="1477.0356">"application": "&lt;upstream-service&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="129" y="1492.1685">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="129" y="1507.3013">"notification": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="137" y="1522.4341">"templateName": "{notificationTemplate}"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="129" y="1537.5669">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="129" y="1552.6997">"recipients": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="137" y="1567.8325">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="149" y="1582.9653">"id": "&lt;user id - optional&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="149" y="1598.0981">"channels": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="157" y="1613.231">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="165" y="1628.3638">"channel": "email",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="165" y="1643.4966">"email": "&lt;Email користувача&gt;"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="157" y="1658.6294">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="149" y="1673.7622">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="149" y="1688.895">"parameters": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="157" y="1704.0278">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="173" y="1719.1606">"key": "&lt;key&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="173" y="1734.2935">"value": "&lt;value&gt;"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="157" y="1749.4263">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="149" y="1764.5591">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="137" y="1779.6919">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="129" y="1794.8247">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="121" y="1809.9575">}</text><polygon fill="#2688D4" points="865.5,1855.2891,875.5,1859.2891,865.5,1863.2891,869.5,1859.2891" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="596.5" x2="871.5" y1="1859.2891" y2="1859.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="603.5" y="1839.0903">Відправка повідомлення користувачу</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="603.5" y="1854.2231">за інформацією з</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57" x="722.5" y="1854.2231">channel</text><polygon fill="#2688D4" points="1152.5,1884.4219,1162.5,1888.4219,1152.5,1892.4219,1156.5,1888.4219" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1158.5" y1="1888.4219" y2="1888.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="894.5" y="1883.356">Валідація повідомлення</text><polygon fill="#2688D4" points="898.5,1898.4219,888.5,1902.4219,898.5,1906.4219,894.5,1902.4219" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="1163.5" y1="1902.4219" y2="1902.4219"/><path d="M1077,1917.4219 L1141,1917.4219 L1141,1924.4219 L1131,1934.4219 L1077,1934.4219 L1077,1917.4219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="31.1328" style="stroke:#000000;stroke-width:2.0;" width="1245" x="1077" y="1917.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="1092" y="1930.4888">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="242" x="1156" y="1929.6323">[У разі помилки валідації по каналу]</text><polygon fill="#2688D4" points="2230.5,1936.5547,2240.5,1940.5547,2230.5,1944.5547,2234.5,1940.5547" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1164.5" x2="2236.5" y1="1940.5547" y2="1940.5547"/><polygon fill="#2688D4" points="1471.5,1987.8203,1481.5,1991.8203,1471.5,1995.8203,1475.5,1991.8203" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1477.5" y1="1991.8203" y2="1991.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="894.5" y="1971.6216">Отримання шаблону для каналу зв'язку</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="894.5" y="1986.7544">(у випадку з diia - створення шаблону)</text><polygon fill="#2688D4" points="2348,2032.0859,2358,2036.0859,2348,2040.0859,2352,2036.0859" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="1483.5" x2="2354" y1="2036.0859" y2="2036.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="1490.5" y="2015.8872">Отримання шаблону (для diia -</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="1490.5" y="2031.02">збереження + отримання)</text><polygon fill="#2688D4" points="1494.5,2046.0859,1484.5,2050.0859,1494.5,2054.0859,1490.5,2050.0859" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1488.5" x2="2359" y1="2050.0859" y2="2050.0859"/><polygon fill="#2688D4" points="898.5,2060.0859,888.5,2064.0859,898.5,2068.0859,894.5,2064.0859" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="1482.5" y1="2064.0859" y2="2064.0859"/><polygon fill="#2688D4" points="1317.5,2089.2188,1327.5,2093.2188,1317.5,2097.2188,1321.5,2093.2188" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1323.5" y1="2093.2188" y2="2093.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305" x="894.5" y="2088.1528">Створення повідомлення для каналу зв'язку</text><polygon fill="#2688D4" points="898.5,2118.3516,888.5,2122.3516,898.5,2126.3516,894.5,2122.3516" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="1328.5" y1="2122.3516" y2="2122.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="904.5" y="2117.2856">Повідомлення для каналу зв'язку</text><path d="M825.5,2137.3516 L889.5,2137.3516 L889.5,2144.3516 L879.5,2154.3516 L825.5,2154.3516 L825.5,2137.3516 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="31.1328" style="stroke:#000000;stroke-width:2.0;" width="1496.5" x="825.5" y="2137.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="840.5" y="2150.4185">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="373" x="904.5" y="2149.562">[У разі помилки при створенні повідомлення з шаблону]</text><polygon fill="#2688D4" points="2230.5,2156.4844,2240.5,2160.4844,2230.5,2164.4844,2234.5,2160.4844" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="887.5" x2="2236.5" y1="2160.4844" y2="2160.4844"/><polygon fill="#2688D4" points="1625.5,2192.6172,1635.5,2196.6172,1625.5,2200.6172,1629.5,2196.6172" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="1631.5" y1="2196.6172" y2="2196.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357" x="894.5" y="2191.5513">Запит на відправку повідомлення до каналу зв'язку</text><polygon fill="#2688D4" points="2668.5,2221.75,2678.5,2225.75,2668.5,2229.75,2672.5,2225.75" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="1637.5" x2="2674.5" y1="2225.75" y2="2225.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="1644.5" y="2220.6841">Публікація в топік каналу зв'язку</text><polygon fill="#2688D4" points="439.5,2250.8828,429.5,2254.8828,439.5,2258.8828,435.5,2254.8828" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="433.5" x2="585.5" y1="2254.8828" y2="2254.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="445.5" y="2249.8169">Подію опрацьовано</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="105" x2="2777" y1="2263.8828" y2="2263.8828"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="199" x="110" y="2274.0933">[Повідомлення не оброблене]</text><polygon fill="#2688D4" points="2230.5,2294.8203,2240.5,2298.8203,2230.5,2302.8203,2234.5,2298.8203" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="2236.5" y1="2298.8203" y2="2298.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="894.5" y="2293.7544">Логування помилки</text><polygon fill="#2688D4" points="2484,2323.9531,2494,2327.9531,2484,2331.9531,2488,2327.9531" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;" x1="887.5" x2="2490" y1="2327.9531" y2="2327.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323" x="894.5" y="2322.8872">Збереження повідомлення до Dead-Letter Topic</text><polygon fill="#2688D4" points="898.5,2337.9531,888.5,2341.9531,898.5,2345.9531,894.5,2341.9531" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="892.5" x2="2495" y1="2341.9531" y2="2341.9531"/><polygon fill="#2688D4" points="439.5,2367.0859,429.5,2371.0859,439.5,2375.0859,435.5,2371.0859" style="stroke:#2688D4;stroke-width:1.0;"/><line style="stroke:#2688D4;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="433.5" x2="585.5" y1="2371.0859" y2="2371.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="445.5" y="2366.02">Подію опрацьовано</text><!--MD5=[60765451de464cfdef2c23875491258c]
@startuml
skinparam shadowing false
skinparam DatabaseBackgroundColor white
skinparam DatabaseBorderColor #2688d4
skinparam QueueBackgroundColor white
skinparam QueueBorderColor #2688d4
skinparam NoteBackgroundColor white
skinparam NoteBorderColor #2688d4
skinparam sequence {
    ArrowColor #2688d4
    ActorBorderColor #2688d4
    LifeLineBorderColor #2688d4
    ParticipantBorderColor #2688d4
    ParticipantBackgroundColor white
    BoxBorderColor #2688d4
    BoxBackgroundColor white
}

queue "'user-notifications'\n Kafka Topic" as user_notifications_kafka_topic

box "Сервіс відправки повідомлень"
  participant "Notification \nEvent Subscriber" as notification_kafka_subscriber
  participant "Notification \nService" as notification_service
  participant "Channel Notification \nValidators" as notification_channel_validators
  participant "Channel Notification \nProducers" as notification_channel_producers
  participant "Notification \nTemplate Service" as notification_template_service
  participant "Channel Notification \nPublishers" as channel_notification_publishers
end box

participant "Сервіс \nналаштувань користувачів" as user_settings_service
participant "Сервіс управління \nкористувачами та доступом" as keycloak
participant "Сервіс логування" as logging_service
database "Сховище \nшаблонів" as template_db

queue "'user-notifications.DLT'\n Kafka Topic" as user_notifications_dlt_kafka_topic
queue "'*-channel-notification'\n Kafka Topic" as channel_notification_topics

== Відправка повідомлень за преференціями користувача ==
alt Відправка повідомлення
notification_kafka_subscriber -> user_notifications_kafka_topic: Зчитування події
    note left
      {
        "context": {
          "system": "Low-code Platform",
          "application": "<bpms.app.name>",
          "businessProcess": "<optional>",
          "businessProcessDefinitionId": "<optional>",
          "businessProcessInstanceId": "<optional>",
          "businessActivity": "<optional>",
          "businessActivityInstanceId": "<optional>"
        },
        "notification": {
          "templateName": "<notification template unique name>"
        },
        "recipients": [
          {
            "id": "<Ідентифікатор користувача>",
            "parameters": [
              {
                  "key": "<key>",
                  "value": "<value>"
              }
            ]
          }
        ]
      }
    end note
activate notification_kafka_subscriber
notification_kafka_subscriber -> notification_service: Відправка повідомлення \nкористувачу <recipient>
activate notification_service
  notification_service -> user_settings_service: Читання налаштувань користувача \n(**username = <recipient>**)
  user_settings_service - -> notification_service: Обрані канали зв'язку з їх налаштуваннями
  notification_service -> keycloak: Читання атрибутів користувача
  keycloak - -> notification_service: Атрибути користувача: РНОКПП, тощо.
  notification_service -> notification_service: Визначення каналів зв'язку (**channel**)
  loop Обробка повідомлення для кожного каналу зв'язку
  notification_service -> notification_channel_validators: Валідація повідомлення
  alt Помилка валідації
    notification_channel_validators -> logging_service: Логування помилки
  end
  notification_channel_validators - -> notification_service
  notification_service -> notification_template_service: Запит на отримання шаблону для каналу зв'язку \n(у випадку з diia - створення шаблону)
  notification_template_service -> template_db: Отримання шаблону
  template_db - -> notification_template_service
  notification_template_service - -> notification_service
  notification_service -> notification_channel_producers: Створення повідомлення для каналу зв'язку
  notification_channel_producers - -> notification_service: Повідомлення для каналів зв'язку
  alt Помилка створення повідомлення з шаблону і моделі
    notification_service -> logging_service: Логування помилки
  end
  end
  notification_service -> channel_notification_publishers: Запит на відправку повідомлень до каналів зв'язку
  channel_notification_publishers -> channel_notification_topics: Публікація в топік каналу зв'язку
  notification_kafka_subscriber - -> user_notifications_kafka_topic: Подію опрацьовано
else Повідомлення не оброблене
  notification_service -> logging_service: Логування помилки
  notification_service -> user_notifications_dlt_kafka_topic: Збереження повідомлення до Dead-Letter Topic
  user_notifications_dlt_kafka_topic - -> notification_service
  notification_kafka_subscriber - -> user_notifications_kafka_topic: Подію опрацьовано
end
deactivate notification_service
deactivate notification_kafka_subscriber

== Відправка повідомлень за визначеним каналом ==

alt Відправка повідомлення
notification_kafka_subscriber -> user_notifications_kafka_topic: Зчитування події
    note left
     {
       "context": {
         "system": "Low-code Platform",
         "application": "<upstream-service>",
       },
       "notification": {
         "templateName": "{notificationTemplate}"
       },
       "recipients": [
         {
            "id": "<user id - optional>",
            "channels": [
              {
                "channel": "email",
                "email": "<Email користувача>"
              }
            ],
            "parameters": [
              {
                  "key": "<key>",
                  "value": "<value>"
              }
            ]
         }
       ]
     }
    end note
activate notification_kafka_subscriber
notification_kafka_subscriber -> notification_service: Відправка повідомлення користувачу \nза інформацією з **channel**
activate notification_service
  notification_service -> notification_channel_validators: Валідація повідомлення
  notification_channel_validators - -> notification_service
    alt У разі помилки валідації по каналу
      notification_channel_validators - -> logging_service
    end
  notification_service -> notification_template_service: Отримання шаблону для каналу зв'язку \n(у випадку з diia - створення шаблону)
  notification_template_service -> template_db: Отримання шаблону (для diia -\nзбереження + отримання)
  template_db - -> notification_template_service
  notification_template_service - -> notification_service
  notification_service -> notification_channel_producers: Створення повідомлення для каналу зв'язку
  notification_channel_producers - -> notification_service: Повідомлення для каналу зв'язку
    alt У разі помилки при створенні повідомлення з шаблону
      notification_service - -> logging_service
    end
  notification_service -> channel_notification_publishers: Запит на відправку повідомлення до каналу зв'язку
  channel_notification_publishers -> channel_notification_topics: Публікація в топік каналу зв'язку
  notification_kafka_subscriber - -> user_notifications_kafka_topic: Подію опрацьовано
else Повідомлення не оброблене
  notification_service -> logging_service: Логування помилки
  notification_service -> user_notifications_dlt_kafka_topic: Збереження повідомлення до Dead-Letter Topic
  user_notifications_dlt_kafka_topic - -> notification_service
  notification_kafka_subscriber - -> user_notifications_kafka_topic: Подію опрацьовано
end
deactivate notification_service
deactivate notification_kafka_subscriber
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>